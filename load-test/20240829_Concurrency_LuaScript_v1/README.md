# JMeter 테스트 보고서: Lua Script 기반 동시성 제어 메커니즘 검증

## 1. 테스트 목적

Redlock에서 Lua Script로 변경된 동시성 제어 메커니즘의 개선 효과 검증

## 2. 테스트 환경

- 테스트 도구: Apache JMeter
- 대상 시스템: 주문 처리 API
- 총 요청 수: 2,000
- 동시 사용자 수: 1,000

## 3. 테스트 시나리오

1. `/api/v1/orders/prepare` 엔드포인트 호출 (GET)
2. `/api/v1/orders/create/{orderId}` 엔드포인트 호출 (POST)

## 4. 테스트 결과 요약

### 4.1 전체 성능 지표

- 총 샘플 수: 2,000
- 총 에러 수: 0 (0%)
- 평균 응답 시간: 259 ms (대폭 감소)
- 중간값 응답 시간: 119 ms
- 90번째 백분위 응답 시간: 654 ms
- 95번째 백분위 응답 시간: 950 ms
- 99번째 백분위 응답 시간: 1,235 ms
- 최소 응답 시간: 24 ms
- 최대 응답 시간: 1,045 ms (극단적 개선)
- 처리량: 약 434.8 requests/second (18배 증가)

### 4.2 엔드포인트별 성능

#### 4.2.1 /api/v1/orders/prepare (GET)

- 샘플 수: 1,000
- 평균 응답 시간: 455 ms (98% 감소)
- 에러율: 0%

#### 4.2.2 /api/v1/orders/create/{orderId} (POST)

- 샘플 수: 1,000
- 평균 응답 시간: 63 ms (99% 감소)
- 에러율: 0%

## 5. Redlock 대비 개선사항 분석

1. **에러율 개선**:

   - Redlock: 0.1% → Lua Script: 0%
   - 시스템 안정성 대폭 향상

2. **응답 시간 획기적 감소**:

   - `prepare` 엔드포인트: 36,252 ms → 455 ms (98% 감소)
   - `create` 엔드포인트: 5,353 ms → 63 ms (99% 감소)
   - Lua Script의 효율적 동시성 제어 입증

3. **처리량 대폭 증가**:

   - Redlock: 23.5 req/s → Lua Script: 434.8 req/s
   - 18배 이상 성능 향상

4. **일관성 향상**:

   - 응답 시간 편차 감소
   - 예측 가능한 성능 제공

5. **자원 효율성**:

   - Redlock의 복잡한 잠금 메커니즘 제거
   - 단일 Lua Script로 간소화되어 자원 사용 효율 증가

6. **확장성 개선**:
   - 높은 처리량과 낮은 응답 시간으로 더 많은 동시 사용자 처리 가능

## 6. 결론 및 향후 계획

1. Lua Script 기반 동시성 제어 메커니즘, Redlock 대비 현저히 우수한 성능 입증

2. 안정성, 응답 시간, 처리량 모든 면에서 괄목할 만한 개선 달성

3. 추가 개선 및 검증 사항:
   - 5,000 또는 10,000 동시 사용자 상황에서 테스트 수행 필요
   - 장기 실행 테스트로 시스템 지속성 검증 권장
   - 다양한 네트워크 조건에서 성능 테스트 수행 필요

결론: Lua Script 기반 새 동시성 제어 메커니즘, 이전 Redlock 방식 대비 효율성과 안정성 크게 향상. 높은 트래픽 상황에서도 안정적 운영 가능할 것으로 예상. 지속적 모니터링과 최적화로 더 나은 성능 달성 가능
