# JMeter 테스트 보고서: Redlock 동시성 제어 메커니즘 검증

## 1. 테스트 목적

Redisson Custom Lock에서 Redlock로 변경된 동시성 제어 메커니즘의 효과성 검증

## 2. 테스트 환경

- 테스트 도구: Apache JMeter
- 대상 시스템: 주문 처리 API
- 총 요청 수: 1,000
- 동시 사용자 수: 1,000

## 3. 테스트 시나리오

1. `/api/v1/orders/prepare` 엔드포인트 호출 (GET)
2. `/api/v1/orders/create/{orderId}` 엔드포인트 호출 (POST)

## 4. 테스트 결과 요약

### 4.1 전체 성능 지표

- 총 샘플 수: 2,000
- 총 에러 수: 2 (0.1%)
- 평균 응답 시간: 20,803 ms (매우 높음)
- 중간값 응답 시간: 19,972 ms
- 90번째 백분위 응답 시간: 37,200 ms
- 95번째 백분위 응답 시간: 38,605 ms
- 99번째 백분위 응답 시간: 39,603 ms
- 최소 응답 시간: 15 ms
- 최대 응답 시간: 40,240 ms (극단적으로 높음)
- 처리량: 23.5 requests/second (낮은 편)

### 4.2 엔드포인트별 성능

#### 4.2.1 /api/v1/orders/prepare (GET)

- 샘플 수: 1,000
- 평균 응답 시간: 36,252 ms (심각하게 높음)
- 에러율: 0.1%

#### 4.2.2 /api/v1/orders/create/{orderId} (POST)

- 샘플 수: 1,000
- 평균 응답 시간: 5,353 ms (높은 편)
- 에러율: 0.1%

## 5. 분석 및 결론

1. **응답 시간**:

   - 전체 평균 응답 시간이 20초 이상으로 매우 높음, 사용자 경험에 심각한 영향 우려
   - `prepare` 엔드포인트의 평균 응답 시간(36초 이상)은 특히 문제. 동시성 제어 로직이 성능에 큰 부담을 주는 것으로 보임
   - `create` 엔드포인트도 5초 이상의 응답 시간을 보여 개선 필요

2. **처리량**: 초당 23.5개 요청 처리는 1,000명의 동시 사용자를 고려할 때 매우 낮은 수준. 시스템의 확장성에 의문 제기

3. **안정성**: 0.1%의 낮은 에러율은 긍정적, 그러나 극단적으로 긴 응답 시간으로 인해 실질적인 시스템 안정성은 낮다고 판단

4. **확장성**: 높은 응답 시간과 낮은 처리량을 고려할 때, 현재 구현의 확장성에 심각한 문제가 있는 것으로 보임

5. **일관성**: 낮은 에러율은 데이터 일관성 측면에서 긍정적. 그러나 긴 응답 시간으로 인한 타임아웃 발생 가능성 고려 필요

## 6. 결론 및 향후 계획

1. **응답 시간 최적화 시급**: 특히 `prepare` 엔드포인트의 로직을 철저히 분석하고 최적화 필요, 가능하다면 비동기 처리 도입 고려

2. **동시성 제어 메커니즘 재검토**: Redlock이 안정성은 제공하나 성능에 심각한 영향을 미치는 것으로 보임, 다른 접근 방식 고려 필요

3. **DB 및 캐시 최적화**: 데이터 접근 패턴을 분석하고, 인덱싱, 캐싱 전략 개선 필요

4. **시스템 리소스 검토**: 현재 시스템 리소스(CPU, 메모리, 네트워크)가 충분한지 검토 필요

5. **단계적 부하 테스트**: 사용자 수를 점진적으로 늘려가며 시스템의 한계점 정확히 파악 필요

6. **상세 프로파일링**: 응답 시간 지연의 정확한 원인을 찾기 위한 상세 프로파일링 수행 필요

결론: Redlock 동시성 제어 메커니즘은 데이터 일관성 측면에서는 효과적으로 작동하나, 성능 측면에서 심각한 문제 발생. 현재 구현으로는 실제 서비스에 적용하기 어려우며, 대대적인 성능 개선 작업 필요.
